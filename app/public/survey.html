<!DOCTYPE html>
<html>
<head>
	<title>Friend Finder App</title>
	<!-- Link compiled and minified CSS & JS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  	<script src="https://code.jquery.com/jquery.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</head>
<body>
<div class = "container">
	<div class = "page-header">
	<h1> Survey Questions </h1>
	</div>

	<h2> About You</h2>

	<form>
		  <div class="form-group">
		    <label for="name-input">Name (Required)</label>
		    <input type="name" class="form-control" id="name-input">
		  </div>

		  <div class="form-group">
		    <label for="photo-link">Link to Photo Image (Required)</label>
		    <input type="photp" class="form-control" id="photo-link">
		  </div>

	 	 	<div class = "page-header"></div>

		<div id = "question1">
			<h3>Question 1</h3>
			<h4>You enjoy going to new places and having new adventures.</h4>	
				<select id = "q1">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5 (Strongly Disagree)</option>
				</select>		
		</div>

		<div id = "question2">
			<h3>Question 2</h3>
			<h4>You prefer to spend time with people who share the same beliefs and morals.",
				</h4>	
			
				<select id ="q2">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5 (Strongly Disagree)</option>
				</select>		
			
		</div>

		<div id = "question3">
			<h3>Question 3</h3>
			<h4>You consider yourself an outgoing extrovert.</h4>	
			
				<select id="q3">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5 (Strongly Disagree)</option>
				</select>	
		</div>

		<div id = "question4">
			<h3>Question 4</h3>
			<h4>People rarely upset you.</h4>	
			
				<select id="q4">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5(Strongly Disagree)</option>
				</select>	
		</div>

		<div id = "question5">
			<h3>Question 5</h3>
			<h4>You feel more energized after spending time alone.</h4>	
				<select id="q5">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5(Strongly Disagree)</option>
				</select>	
		</div>
		
		<div id = "question6">
			<h3>Question 6</h3>
			<h4>You often get carried away by fantasies and ideas.</h4>	
				<select id = "q6">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5(Strongly Disagree)</option>
				</select>	
		</div>

		<div id = "question7">
			<h3>Question 7</h3>
			<h4>You love to travel and/or try exotic foods.</h4>	
			
				<select id="q7">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5(Strongly Disagree)</option>
				</select>	
		</div>

		<div id = "question8">
			<h3>Question 8</h3>
			<h4>It is easy for you to relate to other people's feelings.</h4>	
			
				<select id="q8">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5(Strongly Disagree)</option>
				</select>	
		</div>

		<div id = "question9">
			<h3>Question 9</h3>
			<h4>Generally speaking, you are very logical and don't get caught up in fantasies.</h4>	
			
				<select id="q9">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5(Strongly Disagree)</option>
				</select>	
		</div>

		<div id = "question10">
			<h3>Question 10</h3>
			<h4>You often do things out of sheer curiosity.</h4>
			
				<select id="q10">
					<option value = " " disabled selected>Select an Option</option>
					<option value = "1">1 (Strongly Agree)</option>
					<option value = "2">2</option>
					<option value = "3">3</option>
					<option value = "4">4</option>
					<option value = "5">5(Strongly Disagree)</option>
				</select>	
		</div>		
			<br>
			<br>
		  <button type="submit" class="btn btn-primary btn-lg btn-block" id = "surveySubmit"><span class = "glyphicon glyphicon-ok-circle"></span>  Submit</button>
	
			<div class = "page-header"></div>

			<footer class="footer">
				<p><a href ="/api/friends">API Friends List</a> |<a href="https://github.com/rlawton512/FriendFinder"> GitHub Repo</a></p>
			</footer>
			
		</form>

		 <!-- Modal -->
				<div class="modal fade" id="myModal" role="dialog">
					<div class="modal-dialog">
					
					<!-- Modal content-->
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h3 class="modal-title"><strong>Your Best Match</strong></h3>
						</div>

						<div class="modal-body">
							<h4 id = "newFriendName"></h4>
							<img id ="newFriendPic" src = "#">
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
						</div>
					</div>
    			</div>

</div>

<script type ="text/javascript">

$(document).ready(function(){

	//create click function for the survey in order to process the data
var dif = 100;
var leastDifference = 100;
var bestMatch = {};
	
		$("#surveySubmit").on("click", function(event){
			event.preventDefault();

			//Grab information from the form elements 
			var newFriendData = {
				name: $("#name-input").val().trim(),
				photo: $("#photo-link").val().trim(),
				scores: [
					$("#q1").val(),
					$("#q2").val(),
					$("#q3").val(),
					$("#q4").val(),
					$("#q5").val(),
					$("#q6").val(),
					$("#q7").val(),
					$("#q8").val(),
					$("#q9").val(),
					$("#q10").val(),
				]
			}
		
			// post newFriendData to friend.js 
			$.post("/api/friends", newFriendData, function(){
			
			})


			var currURL = window.location.origin;
			//get best match from list of friends 
			$.get(currURL + "/api/friends", newFriendData, function(data){
				for(var j=0; j<data.length; j++){
					console.log(data)
						dif = 100; 

						//determine the least difference amount of difference in the answers
						for(var i=0; i<=9; i++){
							var num = i + 1; 
							var num2 = "'"+num+"'";
							dif -= (Math.abs(parseInt(newFriendData.scores[i]) - parseInt(data[j].scores + (i+1))));
							// console.log(('response[j].scores' + num));

							if (dif < leastDifference){
									leastDifference = dif;

										bestMatch = {
											name: data[j].name,
											photo: data[j].photo
										}
										console.log(bestMatch);
							}

						$("#newFriendName").text(bestMatch.name);
						$("#newFriendPic").attr("src", bestMatch.photo);
						$("#myModal").modal();	

						}			
				}

				//clear survey data after submission
					$("#name-input").val(" ");
					$("#photo-link").val(" ");
					$("#q1").val(" ");
					$("#q2").val(" ");
					$("#q3").val(" ");
					$("#q4").val(" ");
					$("#q5").val(" ");
					$("#q6").val(" ");
					$("#q7").val(" ");
					$("#q8").val(" ");
					$("#q9").val(" ");
					$("#q10").val(" ");
			})

		})


})

</script>

</body>
</html>